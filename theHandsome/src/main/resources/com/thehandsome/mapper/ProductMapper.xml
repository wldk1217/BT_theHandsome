<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 상품 상세 조회, 상품 컬러 리스트 조회, 상품정보 조회, 카테고리별 상품 조회, 상품 총 개수 조회 쿼리 -->

<mapper namespace="com.thehandsome.mapper.ProductMapper">

	<select id="productGetDetail"
		resultType="com.thehandsome.domain.ProductVO">
		select pid, bname, clarge, cmedium, csmall, pname, pprice, pdetail,
		pinfo, pitem, pmaterial, pcolor, psize, pcountry, pmanufacturer
		from product
		where pid=#{pid}
	</select>

	<select id="productGetColor"
		resultType="com.thehandsome.domain.ColorVO">
		select pid, ccolorcode, cname, ccolorimage, cpreview, cimage1,
		cimage2, cimage3, cimage4, cimage5 from color where pid=#{pid}
	</select>

	<select id="getList"
		resultType="com.thehandsome.domain.ProductVO">
		select p.pid, p.pname, p.pprice, c.cpreview
		from product
		join
		color c on p.pid = c.pid
		where bname=#{bname}
	</select>

	<select id="read" resultType="com.thehandsome.domain.ProductVO">
		select p.pid, bname, clarge, cmedium, csmall,
		pname, pprice, pdetail, c.cimage1, c.cimage2
		from product p
		join color c on p.pid = c.pid
		where bname = #{bname}
	</select>

	<select id="getListWithPaging"
		resultType="com.thehandsome.domain.ProductVO">
 		<![CDATA[
			SELECT p.*, (select pid from color c where p.pid=c.pid) bname
			FROM (select rownum rn, pid, pname, pprice, t01_imageurl, t02_imageurl, bno from 
				(select * from product where clarge = #{param2} and cmedium = #{param3} and csmall = #{param4})) p
			WHERE p.rn > (#{param1.pageNum} -1) * #{param1.amount} and p.rn <= #{param1.pageNum} * #{param1.amount}
    	]]>
	</select>

	<select id="getTotal" resultType="int">
		select count(*) from product
		where clarge = #{param1} and cmedium = #{param2} and csmall =
		#{param3}
	</select>
</mapper>
